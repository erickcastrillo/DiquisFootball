import{g as W,j as n,o as H,a as T,r as y,Q as q,k as V,l as X,m as Z,R as ee}from"./index-DZyfIAu_.js";import{c as Y,a as O,F as C,e as re}from"./object-DCB-L6RT.js";import{u as v,o as Q,F as ae}from"./yup-xyZlI54A.js";import{D as _}from"./Dropdown-5Tw5cCms.js";import"./world-BQlB_TTF.js";import{L as B}from"./LoadingButton-CfXmehaF.js";import{C as P}from"./Card-BcnLHcba.js";import{R as U}from"./Row-D51VfxT-.js";import{C as x}from"./Col-Cz1u6dla.js";import{c as te}from"./checkPasswordStrength-BI5JvUYW.js";import{P as se}from"./ProgressBar-46hf9-_5.js";import{N as M}from"./Nav-Cb3S_MVT.js";import"./ElementChildren-ASgpluZ9.js";import"./InputGroupContext-TwirTIt2.js";import"./DataKey-COGXBUcQ.js";import"./listen-DOhMskc_.js";import"./import-BVqBcx_h.js";import"./usePrevious-mhA-54pg.js";import"./NavContext-DffnGcEX.js";import"./useEventCallback-hjjgLohZ.js";import"./useCallbackRef-BbKjLmD3.js";import"./mergeOptionsWithPopperConfig-C7d_kRm9.js";import"./useWindow-CPm0dSzS.js";import"./warning-DRYvq3ZW.js";import"./contains-xpjwsOxO.js";import"./Button-BuCi24HL.js";import"./hook-BgHE0WuW.js";import"./extends-CF3RwP-h.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./Anchor-vuH6WNCC.js";import"./useMergedRefs-MQSzYiRk.js";import"./NavbarContext-CMhQy4oN.js";import"./Button-CbTZNhGo.js";import"./setPrototypeOf-DgZC2w_0.js";import"./clsx-CH7BE6MN.js";import"./divWithClassName--d4LxeB8.js";import"./Nav-DmckRRIf.js";const R=r=>r.toLowerCase().replace(/ /g,"-").replace(/[^\w-]+/g,""),ne=r=>new Promise((c,o)=>{const d=new FileReader;d.onload=p=>{var u;return c((u=p==null?void 0:p.target)==null?void 0:u.result)},d.onerror=p=>o(p),d.readAsDataURL(r)});var K={},ie=r=>encodeURIComponent(r).replace(/[!'()*]/g,c=>`%${c.charCodeAt(0).toString(16).toUpperCase()}`),G="%[a-f0-9]{2}",z=new RegExp("("+G+")|([^%]+?)","gi"),k=new RegExp("("+G+")+","gi");function $(r,c){try{return[decodeURIComponent(r.join(""))]}catch{}if(r.length===1)return r;c=c||1;var o=r.slice(0,c),d=r.slice(c);return Array.prototype.concat.call([],$(o),$(d))}function ce(r){try{return decodeURIComponent(r)}catch{for(var c=r.match(z)||[],o=1;o<c.length;o++)r=$(c,o).join(""),c=r.match(z)||[];return r}}function le(r){for(var c={"%FE%FF":"��","%FF%FE":"��"},o=k.exec(r);o;){try{c[o[0]]=decodeURIComponent(o[0])}catch{var d=ce(o[0]);d!==o[0]&&(c[o[0]]=d)}o=k.exec(r)}c["%C2"]="�";for(var p=Object.keys(c),u=0;u<p.length;u++){var h=p[u];r=r.replace(new RegExp(h,"g"),c[h])}return r}var oe=function(r){if(typeof r!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof r+"`");try{return r=r.replace(/\+/g," "),decodeURIComponent(r)}catch{return le(r)}},me=(r,c)=>{if(!(typeof r=="string"&&typeof c=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(c==="")return[r];const o=r.indexOf(c);return o===-1?[r]:[r.slice(0,o),r.slice(o+c.length)]},de=function(r,c){for(var o={},d=Object.keys(r),p=Array.isArray(c),u=0;u<d.length;u++){var h=d[u],j=r[h];(p?c.indexOf(h)!==-1:c(h,j,r))&&(o[h]=j)}return o};(function(r){const c=ie,o=oe,d=me,p=de,u=e=>e==null,h=Symbol("encodeFragmentIdentifier");function j(e){switch(e.arrayFormat){case"index":return a=>(s,t)=>{const i=s.length;return t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,[m(a,e),"[",i,"]"].join("")]:[...s,[m(a,e),"[",m(i,e),"]=",m(t,e)].join("")]};case"bracket":return a=>(s,t)=>t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,[m(a,e),"[]"].join("")]:[...s,[m(a,e),"[]=",m(t,e)].join("")];case"colon-list-separator":return a=>(s,t)=>t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,[m(a,e),":list="].join("")]:[...s,[m(a,e),":list=",m(t,e)].join("")];case"comma":case"separator":case"bracket-separator":{const a=e.arrayFormat==="bracket-separator"?"[]=":"=";return s=>(t,i)=>i===void 0||e.skipNull&&i===null||e.skipEmptyString&&i===""?t:(i=i===null?"":i,t.length===0?[[m(s,e),a,m(i,e)].join("")]:[[t,m(i,e)].join(e.arrayFormatSeparator)])}default:return a=>(s,t)=>t===void 0||e.skipNull&&t===null||e.skipEmptyString&&t===""?s:t===null?[...s,m(a,e)]:[...s,[m(a,e),"=",m(t,e)].join("")]}}function w(e){let a;switch(e.arrayFormat){case"index":return(s,t,i)=>{if(a=/\[(\d*)\]$/.exec(s),s=s.replace(/\[\d*\]$/,""),!a){i[s]=t;return}i[s]===void 0&&(i[s]={}),i[s][a[1]]=t};case"bracket":return(s,t,i)=>{if(a=/(\[\])$/.exec(s),s=s.replace(/\[\]$/,""),!a){i[s]=t;return}if(i[s]===void 0){i[s]=[t];return}i[s]=[].concat(i[s],t)};case"colon-list-separator":return(s,t,i)=>{if(a=/(:list)$/.exec(s),s=s.replace(/:list$/,""),!a){i[s]=t;return}if(i[s]===void 0){i[s]=[t];return}i[s]=[].concat(i[s],t)};case"comma":case"separator":return(s,t,i)=>{const f=typeof t=="string"&&t.includes(e.arrayFormatSeparator),l=typeof t=="string"&&!f&&g(t,e).includes(e.arrayFormatSeparator);t=l?g(t,e):t;const N=f||l?t.split(e.arrayFormatSeparator).map(J=>g(J,e)):t===null?t:g(t,e);i[s]=N};case"bracket-separator":return(s,t,i)=>{const f=/(\[\])$/.test(s);if(s=s.replace(/\[\]$/,""),!f){i[s]=t&&g(t,e);return}const l=t===null?[]:t.split(e.arrayFormatSeparator).map(N=>g(N,e));if(i[s]===void 0){i[s]=l;return}i[s]=[].concat(i[s],l)};default:return(s,t,i)=>{if(i[s]===void 0){i[s]=t;return}i[s]=[].concat(i[s],t)}}}function b(e){if(typeof e!="string"||e.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function m(e,a){return a.encode?a.strict?c(e):encodeURIComponent(e):e}function g(e,a){return a.decode?o(e):e}function A(e){return Array.isArray(e)?e.sort():typeof e=="object"?A(Object.keys(e)).sort((a,s)=>Number(a)-Number(s)).map(a=>e[a]):e}function E(e){const a=e.indexOf("#");return a!==-1&&(e=e.slice(0,a)),e}function I(e){let a="";const s=e.indexOf("#");return s!==-1&&(a=e.slice(s)),a}function D(e){e=E(e);const a=e.indexOf("?");return a===-1?"":e.slice(a+1)}function F(e,a){return a.parseNumbers&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?e=Number(e):a.parseBooleans&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&(e=e.toLowerCase()==="true"),e}function S(e,a){a=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},a),b(a.arrayFormatSeparator);const s=w(a),t=Object.create(null);if(typeof e!="string"||(e=e.trim().replace(/^[?#&]/,""),!e))return t;for(const i of e.split("&")){if(i==="")continue;let[f,l]=d(a.decode?i.replace(/\+/g," "):i,"=");l=l===void 0?null:["comma","separator","bracket-separator"].includes(a.arrayFormat)?l:g(l,a),s(g(f,a),l,t)}for(const i of Object.keys(t)){const f=t[i];if(typeof f=="object"&&f!==null)for(const l of Object.keys(f))f[l]=F(f[l],a);else t[i]=F(f,a)}return a.sort===!1?t:(a.sort===!0?Object.keys(t).sort():Object.keys(t).sort(a.sort)).reduce((i,f)=>{const l=t[f];return l&&typeof l=="object"&&!Array.isArray(l)?i[f]=A(l):i[f]=l,i},Object.create(null))}r.extract=D,r.parse=S,r.stringify=(e,a)=>{if(!e)return"";a=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},a),b(a.arrayFormatSeparator);const s=l=>a.skipNull&&u(e[l])||a.skipEmptyString&&e[l]==="",t=j(a),i={};for(const l of Object.keys(e))s(l)||(i[l]=e[l]);const f=Object.keys(i);return a.sort!==!1&&f.sort(a.sort),f.map(l=>{const N=e[l];return N===void 0?"":N===null?m(l,a):Array.isArray(N)?N.length===0&&a.arrayFormat==="bracket-separator"?m(l,a)+"[]":N.reduce(t(l),[]).join("&"):m(l,a)+"="+m(N,a)}).filter(l=>l.length>0).join("&")},r.parseUrl=(e,a)=>{a=Object.assign({decode:!0},a);const[s,t]=d(e,"#");return Object.assign({url:s.split("?")[0]||"",query:S(D(e),a)},a&&a.parseFragmentIdentifier&&t?{fragmentIdentifier:g(t,a)}:{})},r.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0,[h]:!0},a);const s=E(e.url).split("?")[0]||"",t=r.extract(e.url),i=r.parse(t,{sort:!1}),f=Object.assign(i,e.query);let l=r.stringify(f,a);l&&(l=`?${l}`);let N=I(e.url);return e.fragmentIdentifier&&(N=`#${a[h]?m(e.fragmentIdentifier,a):e.fragmentIdentifier}`),`${s}${l}${N}`},r.pick=(e,a,s)=>{s=Object.assign({parseFragmentIdentifier:!0,[h]:!1},s);const{url:t,query:i,fragmentIdentifier:f}=r.parseUrl(e,s);return r.stringifyUrl({url:t,query:p(i,a),fragmentIdentifier:f},s)},r.exclude=(e,a,s)=>{const t=Array.isArray(a)?i=>!a.includes(i):(i,f)=>!a(i,f);return r.pick(e,t,s)}})(K);const fe=W(K),ue=r=>{const c=o=>{r.handleImageUpdate(o)};return n.jsx("div",{className:"profile-avatar__cta",children:n.jsxs(_,{autoClose:!1,children:[n.jsx(_.Toggle,{className:"arrow-none rounded-circle btn-sm p-0",id:"dropdown-basic",children:n.jsx("i",{className:"mdi mdi-camera font-16"})}),n.jsx(_.Menu,{children:n.jsx(_.Item,{as:"div",className:"cursor-pointer",children:n.jsxs("label",{htmlFor:"icon-button-file",children:[n.jsx("input",{onChange:c,name:"imageFile",type:"file",accept:"image/*",id:"icon-button-file",style:{display:"none"}}),n.jsx("span",{children:"Upload Picture"})]})})})]})})},he=()=>{const{accountStore:{currentUser:r,updateCurrentUser:c,updateProfileImage:o}}=T(),[d,p]=y.useState(r==null?void 0:r.imageUrl),[u,h]=y.useState({id:(r==null?void 0:r.id)||"",firstName:(r==null?void 0:r.firstName)||"",lastName:(r==null?void 0:r.lastName)||"",phoneNumber:(r==null?void 0:r.phoneNumber)||"",email:(r==null?void 0:r.email)||""}),j=Y({firstName:O().min(3,"Too Short").required("First Name is Required!"),lastName:O().required("Last Name is Required!"),email:O().required("The email is required").email(),phoneNumber:O().optional()}),w={firstName:u.firstName||"",lastName:u.lastName||"",email:u.email||"",phoneNumber:u.phoneNumber||""},{register:b,handleSubmit:m,reset:g,formState:{isDirty:A,isValid:E,isSubmitting:I}}=v({defaultValues:w,resolver:Q(j)}),D=async e=>{try{await c({...u,...e}),q.success("Profile Updated"),g(),h(a=>({...a,...e}))}catch(a){const s=(a==null?void 0:a.message)||"Update profile failed";q.error(s)}},F=async e=>{var a,s;try{const t=(s=(a=e.target)==null?void 0:a.files)==null?void 0:s[0];await o({ImageFile:t});const f=await ne(t);f&&p(f)}catch(t){const i=(t==null?void 0:t.message)||"Upload image failed";q.error(i)}},S=async()=>{await o({DeleteCurrentImage:!0}),p("")};return y.useEffect(()=>{r&&g({email:r.email,firstName:r.firstName,lastName:r.lastName,phoneNumber:r.phoneNumber||""})},[r]),n.jsx(P,{className:"p-2 pb-5",children:n.jsxs(P.Body,{children:[n.jsx("div",{className:"form-block-title",children:"Edit your account information:"}),n.jsx("div",{children:n.jsxs("div",{className:"profile-avatar profile-avatar--large mb-2",children:[n.jsx("div",{className:"profile-avatar__image-area",children:d||r!=null&&r.imageUrl?n.jsx("img",{src:d||(r==null?void 0:r.imageUrl),id:"profileImage"}):n.jsx("i",{className:"mdi mdi-account-outline"})}),n.jsx(ue,{handleImageUpdate:F,handleImageRemove:S}),n.jsxs("div",{className:"profile-avatar__title-group",children:[n.jsxs("div",{className:"profile-avatar__title-group__title text-capitalize",id:"nameDisplay",children:[r==null?void 0:r.firstName," ",r==null?void 0:r.lastName]}),n.jsxs("div",{className:"profile-avatar__title-group__sub text-capitalize",id:"roleDisplay",children:[r==null?void 0:r.roleId," Level User"]})]})]})}),n.jsx("form",{onSubmit:m(D),children:n.jsxs(U,{className:"mt-2",children:[n.jsx(x,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"First Name",placeholder:"First Name",register:b,name:"firstName"})}),n.jsx(x,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"Last Name",placeholder:"Last Name",register:b,name:"lastName"})}),n.jsx(x,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"Email",placeholder:"Email",register:b,name:"email"})}),n.jsx(x,{className:"mt-3",xs:12,sm:6,children:n.jsx(C,{label:"Phone number",placeholder:"Phone number",register:b,name:"phoneNumber"})}),n.jsx(x,{xs:12,className:"d-flex justify-content-end mt-4",children:n.jsx(B,{type:"submit",variant:"primary",disabled:!A||!E||I,loading:I,children:"Save Changes"})})]})})]})})},pe=H(he),ge=()=>{const{accountStore:r}=T(),{changePassword:c}=r,[o,d]=y.useState(0),p={password:"",newPassword:"",confirmNewPassword:""},u=Y({password:O().required("Current password is required!"),newPassword:O().required("New password is required!"),confirmNewPassword:O().required("Confirm new password is required!").oneOf([re("newPassword")],"Your passwords do not match!")}),{register:h,handleSubmit:j,reset:w,formState:{isDirty:b,isValid:m,isSubmitting:g},watch:A}=v({defaultValues:p,resolver:Q(u)}),E=A("newPassword"),I=y.useCallback(()=>{const F=te(E,{checkFor:["length","lowerCase","upperCase","number"]}).strength;d(F)},[E]),D=async F=>{try{await c(F),q.success("Password updated"),d(0),w()}catch(S){const e=(S==null?void 0:S.message)||"Password update failed";q.error(e)}};return y.useEffect(()=>{I()},[I]),n.jsx(P,{className:"p-2 pb-5",children:n.jsxs(P.Body,{children:[n.jsx("div",{className:"form-block-title",children:"Update Your Password:"}),n.jsx("form",{onSubmit:j(D),children:n.jsxs(U,{children:[n.jsx(x,{className:"mt-3",xs:12,md:6,children:n.jsx(C,{type:"password",className:"w-100",label:"Current Password",placeholder:"Enter current password",register:h,name:"password"})}),n.jsx(x,{className:"mt-3",xs:0,md:6}),n.jsxs(x,{xs:12,md:6,className:"d-flex flex-column gap-1 mt-3",children:[n.jsx(C,{type:"password",className:"w-100",label:"New Password",placeholder:"Enter new password",register:h,name:"newPassword"}),n.jsx(se,{now:o,className:"progress-sm"})]}),n.jsx(x,{className:"mt-3",xs:12,md:6,children:n.jsx(C,{type:"password",className:"w-100",label:"Confirm New Password",placeholder:"Confirm new password",register:h,name:"confirmNewPassword"})}),n.jsx(x,{xs:12,children:n.jsxs("div",{className:"pt-3",children:[n.jsx("h6",{className:"fs-5 fw-bolder",children:"Password requirements:"}),n.jsx("small",{className:"fw-semibold text-body-tertiary",children:"Ensure that these requirements are met:"}),n.jsxs("ul",{children:[n.jsx("li",{className:"fs-6 text-body-tertiary",children:"Minimum 6 characters long"}),n.jsx("li",{className:"fs-6 text-body-tertiary",children:"At least one lowercase character"}),n.jsx("li",{className:"fs-6 text-body-tertiary",children:"At least one uppercase character"}),n.jsx("li",{className:"fs-6 text-body-tertiary",children:"At least one number"})]})]})}),n.jsx(x,{xs:12,className:"d-flex justify-content-end",children:n.jsx(B,{variant:"primary",disabled:!b||!m||g,loading:g,type:"submit",children:"Save Changes"})})]})})]})})},xe=()=>{const{layoutStore:r}=T(),[c,o]=y.useState({darkModeDefault:r.theme===V.LAYOUT_THEME_DARK,pageSizeDefault:r.pageSize}),{register:d,handleSubmit:p,reset:u,formState:{isDirty:h,isValid:j,isSubmitting:w}}=v({defaultValues:c}),b=async m=>{r.changeTheme(m.darkModeDefault?V.LAYOUT_THEME_DARK:V.LAYOUT_THEME_LIGHT),r.changePageSize(m.pageSizeDefault),q.success("Preferences Updated"),o(m)};return n.jsx(P,{className:"p-2 pb-5",children:n.jsxs(P.Body,{children:[n.jsx("div",{className:"form-block-title",children:"Preferences:"}),n.jsxs("form",{onSubmit:p(b),children:[n.jsxs(U,{className:"gap-4",children:[n.jsxs(x,{xs:7,mt:2,children:[n.jsx("p",{className:"fs-5 fw-bolder mb-1",children:"Page Size Default"}),n.jsx(C,{type:"select",className:"w-25",register:d,name:"pageSizeDefault",children:[5,10,25,50,100].map((m,g)=>n.jsx("option",{value:m,className:"fs-6 fw-semibold",children:m},g))})]}),n.jsx(x,{xs:7,children:n.jsx(ae.Switch,{label:"Dark mode",...d("darkModeDefault")})})]}),n.jsx("div",{className:"d-flex justify-content-end",children:n.jsx(B,{type:"submit",variant:"primary",disabled:!h||!j||w,loading:w,children:"Save Changes"})})]})]})})},je=H(xe),ar=()=>{const{authStore:r}=T(),c=X(),o=Z();y.useEffect(()=>{r.setTitle("Profile")},[]);const[d,p]=y.useState("user-info");return ee.useEffect(()=>{if(!o.search)return;const u=fe.parse(o.search);u.tab&&p(u.tab)},[o]),n.jsx("div",{className:"pt-2 pb-4",children:n.jsxs(U,{children:[n.jsx(x,{xxl:2,xl:3,lg:4,children:n.jsx(P,{children:n.jsx(P.Body,{className:"px-2",children:n.jsx(M,{variant:"pills",children:L.map(({id:u,name:h,icon:j})=>n.jsx(M.Item,{className:"w-100",children:n.jsxs(M.Link,{active:d===R(h),className:"d-flex items-center",onClick:()=>c(`/profile?tab=${R(h)}`),children:[n.jsx("i",{className:`${j} me-1`}),n.jsx("span",{className:"",children:h})]})},u))})})})}),n.jsxs(x,{xxl:10,xl:9,lg:8,children:[d===R(L[0].name)&&n.jsx(pe,{}),d===R(L[1].name)&&n.jsx(je,{}),d===R(L[2].name)&&n.jsx(ge,{})]})]})})},L=[{id:1,name:"User Info",icon:"mdi mdi-account-circle"},{id:2,name:"Preferences",icon:"mdi mdi-account-edit"},{id:3,name:"Password",icon:"mdi mdi-lifebuoy"}];export{ar as default};
