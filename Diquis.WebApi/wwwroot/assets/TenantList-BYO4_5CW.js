import{o as N,a as T,b as E,r as h,j as e,Q as f,S as I}from"./index-BuddXFJa.js";import{c as D}from"./clsx-CH7BE6MN.js";import{u as R,M as K,g as $}from"./index-CxgsWqyv.js";import{c as F,F as u,a as d,b as z}from"./object-D5dWmyPz.js";import{u as A,o as B}from"./yup-4rNH33YR.js";import"./world-6iAZiOYV.js";import{L as k}from"./LoadingButton-D8QngUfh.js";import{M as P}from"./Modal-CZAMj_a-.js";import{R as C}from"./Row-WHEMrags.js";import{C as g}from"./Col-CHpB3Dvb.js";import{B as q}from"./Button-DlzCx1S-.js";import{B as U}from"./Badge-CweuOcN1.js";import{A as V}from"./Alert-C7GMvBtR.js";import{C as O}from"./ClientTable-vz4GVEQp.js";import{P as G}from"./PageLayout-DWsBajcI.js";import{C as L}from"./Card-iRK5woST.js";import"./ElementChildren-CLZbOutP.js";import"./InputGroupContext-geSFbXYA.js";import"./setPrototypeOf-DgZC2w_0.js";import"./warning-DfXNGSKl.js";import"./listen-DOhMskc_.js";import"./useCallbackRef-DyJyIoj-.js";import"./useEventCallback-ddhfBO5d.js";import"./useMergedRefs-DAOCdGkL.js";import"./hasClass-D5wS-QxG.js";import"./useWindow-CSeaQGg-.js";import"./NoopTransition-CRW_zv4_.js";import"./TransitionWrapper-CTn4BG31.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./AbstractModalHeader-7OysnIQb.js";import"./contains-xpjwsOxO.js";import"./usePrevious-BWh7Y2MO.js";import"./DataKey-COGXBUcQ.js";import"./CloseButton-C9B4ytzo.js";import"./Fade-Ck_9hL87.js";import"./divWithClassName-Cv15O8OV.js";import"./Button-_NMu-vvO.js";import"./hook-CPDfY6vG.js";import"./extends-CF3RwP-h.js";import"./Anchor-Bjrjb0MC.js";import"./simplebar-react.esm-DmWE8OId.js";import"./index-D_Z5TGVk.js";const H=s=>F().shape({name:d().required(s("tenants.editModal.validation.nameRequired")),id:d().required(),isActive:z().required(),createdOn:d().required(),status:d().oneOf(["Pending","Provisioning","Active","Failed","Updating"]).required(),provisioningError:d().optional(),lastProvisioningAttempt:d().optional()}),Q=({show:s,onHide:a,data:n})=>{const{tenantsStore:i}=T(),{updateTenant:c,loading:t}=i,{t:r}=E(),m=h.useMemo(()=>H(r),[r]),{reset:o,register:l,handleSubmit:x,formState:{isDirty:b,isValid:v,isSubmitting:j}}=A({defaultValues:n,resolver:B(m)}),M=()=>{o(),a()},S=async y=>{try{await c(y),a(),o(),f.info(r("tenants.editModal.editSuccess"))}catch(p){const w=(p==null?void 0:p.message)||r("tenants.editModal.editFailed");f.error(w)}};return e.jsxs(P,{show:s,onHide:M,size:"lg",centered:!0,children:[e.jsx(P.Header,{closeButton:!0,children:e.jsx("h2",{className:"mb-2 fs-3",children:r("tenants.editModal.editTitle")})}),e.jsx(P.Body,{children:e.jsxs("form",{onSubmit:x(S),children:[e.jsxs(C,{className:"mt-1",children:[e.jsx(g,{className:"mt-2",xs:7,children:e.jsx(u,{type:"text",placeholder:r("tenants.editModal.namePlaceholder"),label:r("tenants.editModal.nameLabel"),register:l,name:"name"})}),e.jsx(g,{className:"mt-2",xs:7,children:e.jsx(u,{type:"checkbox",label:r("tenants.editModal.isActiveLabel"),register:l,name:"isActive"})})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-3 gap-2",children:[e.jsx(q,{variant:"light",onClick:a,children:r("tenants.editModal.cancel")}),e.jsx(k,{type:"submit",variant:"primary",disabled:!b||!v||j,loading:j||t,children:r("tenants.editModal.save")})]})]})})]})},Y=N(Q),_=({status:s})=>{const n=(i=>({Pending:{variant:"secondary",label:"Pending",icon:"?",showSpinner:!1},Provisioning:{variant:"info",label:"Provisioning...",icon:null,showSpinner:!0},Active:{variant:"success",label:"Active",icon:"?",showSpinner:!1},Failed:{variant:"danger",label:"Failed",icon:"?",showSpinner:!1},Updating:{variant:"warning",label:"Updating...",icon:null,showSpinner:!0}})[i])(s);return e.jsxs(U,{bg:n.variant,className:"d-flex align-items-center gap-1",style:{width:"fit-content"},children:[n.showSpinner&&e.jsx(I,{animation:"border",size:"sm",style:{width:"12px",height:"12px"}}),n.icon&&e.jsx("span",{children:n.icon}),e.jsx("span",{children:n.label})]})},J=({t:s})=>[{header:s("tenants.columns.id"),accessorKey:"id",enableSorting:!0,cell:({row:a})=>{const{id:n}=a.original;return e.jsx("div",{className:"table-profile-component",children:e.jsx("strong",{children:n})})}},{header:s("tenants.columns.name"),enableSorting:!0,accessorKey:"name",cell:({row:a})=>{const{name:n,provisioningError:i}=a.original;return e.jsxs("div",{children:[e.jsx("div",{children:n}),i&&e.jsxs(V,{variant:"danger",className:"mt-1 mb-0 p-1",style:{fontSize:"0.75rem"},children:[e.jsx("strong",{children:"Error:"})," ",i]})]})}},{header:s("tenants.columns.status"),enableSorting:!0,accessorKey:"status",cell:({row:a})=>{const{status:n}=a.original;return e.jsx(_,{status:n})}},{header:s("tenants.columns.active"),enableSorting:!0,accessorKey:"isActive",enableGlobalFilter:!1,cell:({getValue:a})=>{var n,i;return e.jsx("strong",{className:D(((n=a())==null?void 0:n.toString().toLowerCase())==="true"?"text-success":"text-danger","text-capitalize"),children:((i=a())==null?void 0:i.toString())=="true"?s("common.yes"):s("common.no")})}},{header:"",accessorKey:"edit",cell:({row:a})=>{const{id:n,status:i}=a.original,{show:c,onShow:t,onHide:r}=R(),m=i==="Provisioning"||i==="Updating"||i==="Pending";return e.jsxs(e.Fragment,{children:[n!="root"?e.jsx("button",{className:"btn btn-soft-primary rounded-pill",onClick:t,disabled:m,children:s("tenants.columns.edit")}):s("tenants.columns.naYou"),c&&e.jsx(Y,{show:c,onHide:r,data:a.original})]})}}],W=({show:s,onHide:a})=>{const{tenantsStore:n}=T(),{createTenant:i,loading:c}=n,{t}=E(),r=h.useMemo(()=>({id:"",name:"",adminEmail:"",password:"Password123!",hasIsolatedDatabase:!1}),[]),m=F({id:d().required(t("tenants.registerModal.validation.keyRequired")),name:d().required(t("tenants.registerModal.validation.nameRequired")),adminEmail:d().required(t("tenants.registerModal.validation.adminEmailRequired")).email(t("tenants.registerModal.validation.adminEmailInvalid")),password:d().required(t("tenants.registerModal.validation.passwordRequired"))}),{reset:o,register:l,handleSubmit:x,formState:{isDirty:b,isValid:v,isSubmitting:j}}=A({defaultValues:r,resolver:B(m)}),M=()=>{o(),a()},S=async y=>{try{await i(y),o(),a(),f.success(t("tenants.registerModal.createSuccess"))}catch(p){const w=(p==null?void 0:p.message)||t("tenants.registerModal.createFailed");f.error(w)}};return e.jsx(K,{show:s,onHide:M,headerTitle:t("tenants.registerModal.addTitle"),children:e.jsxs("form",{onSubmit:x(S),children:[e.jsxs(C,{className:"mt-2",children:[e.jsx(g,{className:"mt-2",xs:6,children:e.jsx(u,{type:"text",placeholder:t("tenants.registerModal.tenantIdPlaceholder"),label:t("tenants.registerModal.tenantIdLabel"),register:l,name:"id"})}),e.jsx(g,{className:"mt-2",xs:6,children:e.jsx(u,{type:"text",placeholder:t("tenants.registerModal.namePlaceholder"),label:t("tenants.registerModal.nameLabel"),register:l,name:"name"})}),e.jsx(g,{className:"mt-2",xs:6,children:e.jsx(u,{type:"text",placeholder:t("tenants.registerModal.adminEmailPlaceholder"),label:t("tenants.registerModal.adminEmailLabel"),register:l,name:"adminEmail"})}),e.jsx(g,{className:"mt-2",xs:6,children:e.jsx(u,{type:"text",placeholder:t("tenants.registerModal.passwordPlaceholder"),label:t("tenants.registerModal.passwordLabel"),register:l,name:"password"})})]}),e.jsx(C,{children:e.jsx(g,{xs:6,children:e.jsx(u,{type:"checkbox",label:t("tenants.registerModal.isolatedDatabaseLabel"),register:l,name:"hasIsolatedDatabase"})})}),e.jsxs("div",{className:"d-flex justify-content-end mt-4 gap-2",children:[e.jsx(q,{variant:"light",onClick:a,children:t("tenants.registerModal.cancel")}),e.jsx(k,{type:"submit",variant:"primary",disabled:!b||!v||j,loading:j||c,children:t("tenants.registerModal.save")})]})]})})},X=N(W),Z=()=>{const{tenantsStore:s,authStore:a}=T(),{loadTenants:n,tenantsSorted:i,loadingInitial:c}=s,{show:t,onShow:r,onHide:m}=R(),{t:o,i18n:l}=E();h.useEffect(()=>{a.setTitle(o("tenants.title"))},[o,a,l.language]);const x=h.useMemo(()=>i,[i]),b=h.useMemo(()=>J({t:o}),[o]);return h.useEffect(()=>{n()},[n]),e.jsxs(G,{action:e.jsx(q,{variant:"primary",onClick:r,children:o("tenants.addTenant")}),children:[e.jsx(X,{show:t,onHide:m}),e.jsx(L,{className:"pt-2",children:e.jsx(L.Body,{children:e.jsx(O,{data:x,columns:b,getCoreRowModel:$(),isLoading:c,filterFieldPlaceholder:o("tenants.searchPlaceholder")})})}),e.jsx("div",{className:"mb-2",children:e.jsx("small",{children:o("tenants.paginationDescription")})})]})},Ue=N(Z);export{Ue as default};
