import{o as I,a as w,b as P,r as N,j as e,Q as j}from"./index-BuddXFJa.js";import{C as $}from"./ClientTable-vz4GVEQp.js";import{c as k}from"./clsx-CH7BE6MN.js";import{c as B,b as G,a as m,F as o}from"./object-D5dWmyPz.js";import{u as T,o as z}from"./yup-4rNH33YR.js";import{L as q}from"./LoadingButton-D8QngUfh.js";import{M as E,u as D,g as V}from"./index-CxgsWqyv.js";import"./world-6iAZiOYV.js";import{R as K}from"./Row-WHEMrags.js";import{C as d}from"./Col-CHpB3Dvb.js";import{S as O}from"./Stack-QuHCA6a6.js";import{B as A}from"./Button-DlzCx1S-.js";import{A as Q}from"./Avatar-tFBoQ1hH.js";import{g as Y}from"./getInitials-fn6u8gr9.js";import{B as _}from"./Badge-CweuOcN1.js";import{P as H}from"./PageLayout-DWsBajcI.js";import{C as F}from"./Card-iRK5woST.js";import"./simplebar-react.esm-DmWE8OId.js";import"./index-D_Z5TGVk.js";import"./ElementChildren-CLZbOutP.js";import"./InputGroupContext-geSFbXYA.js";import"./Modal-CZAMj_a-.js";import"./listen-DOhMskc_.js";import"./useCallbackRef-DyJyIoj-.js";import"./useEventCallback-ddhfBO5d.js";import"./useMergedRefs-DAOCdGkL.js";import"./hasClass-D5wS-QxG.js";import"./useWindow-CSeaQGg-.js";import"./NoopTransition-CRW_zv4_.js";import"./TransitionWrapper-CTn4BG31.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./setPrototypeOf-DgZC2w_0.js";import"./AbstractModalHeader-7OysnIQb.js";import"./contains-xpjwsOxO.js";import"./usePrevious-BWh7Y2MO.js";import"./DataKey-COGXBUcQ.js";import"./CloseButton-C9B4ytzo.js";import"./Fade-Ck_9hL87.js";import"./divWithClassName-Cv15O8OV.js";import"./warning-DfXNGSKl.js";import"./Button-_NMu-vvO.js";const J=({show:l,onHide:t,data:r})=>{const{usersStore:i}=w(),{updateAppUser:n,loading:a,loadingDelete:p,deleteAppUser:x}=i,{t:s}=P(),c=N.useMemo(()=>({id:r.id,firstName:r.firstName,lastName:r.lastName,email:r.email,phoneNumber:r.phoneNumber,isActive:r.isActive,roleId:r.roleId,imageUrl:r.imageUrl,createdOn:r.createdOn}),[r]),f=B({firstName:m().required(s("users.editModal.validation.firstNameRequired")),lastName:m().required(s("users.editModal.validation.lastNameRequired")),email:m().required(s("users.editModal.validation.emailRequired")).email(s("users.editModal.validation.emailInvalid")),phoneNumner:m(),roleId:m().oneOf(["admin","editor","basic"]),isActive:G()}),{reset:M,register:h,handleSubmit:S,formState:{isDirty:v,isValid:C,isSubmitting:u}}=T({defaultValues:c,resolver:z(f)}),y=async g=>{try{await x(g),j.error(s("users.editModal.deleteSuccess")),t()}catch(b){const R=(b==null?void 0:b.message)||s("users.editModal.deleteFailed");j.error(R)}},U=async g=>{try{await n(g),j.info(s("users.editModal.editSuccess")),t(),M()}catch(b){const R=(b==null?void 0:b.message)||s("users.editModal.editFailed");j.error(R)}},L=r.roleId==="root";return e.jsx(E,{show:l,onHide:t,headerTitle:s("users.editModal.editTitle"),children:e.jsxs("form",{onSubmit:S(U),children:[e.jsxs(K,{className:"mt-1",children:[!L&&e.jsx(d,{className:"mt-2",xs:12,children:e.jsx(o,{type:"checkbox",label:s("users.editModal.isActiveLabel"),register:h,name:"isActive"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:s("users.editModal.firstNameLabel"),placeholder:s("users.editModal.firstNamePlaceholder"),register:h,name:"firstName"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:s("users.editModal.lastNameLabel"),placeholder:s("users.editModal.lastNamePlaceholder"),register:h,name:"lastName"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:s("users.editModal.emailLabel"),placeholder:s("users.editModal.emailPlaceholder"),register:h,name:"email"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:s("users.editModal.phoneNumberLabel"),placeholder:s("users.editModal.phoneNumberPlaceholder"),register:h,name:"phoneNumber"})}),!L&&e.jsxs(d,{className:"mt-2",xs:12,children:[e.jsx("h6",{className:"fs-6 mb-1",children:s("users.editModal.roleLabel")}),e.jsx(O,{direction:"horizontal",gap:1,children:["admin","editor","basic"].map(g=>e.jsx(o,{type:"radio",value:g,label:g,register:h,name:"roleId",className:"text-capitalize"},g))})]})]}),e.jsxs("div",{className:k("d-flex",L?"justify-content-end":"justify-content-between","mt-4"),children:[!L&&e.jsx(q,{variant:"danger",loading:p,onClick:()=>y(r.id),children:s("users.editModal.delete")}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(A,{variant:"light",onClick:t,children:s("users.editModal.cancel")}),e.jsx(q,{type:"submit",variant:"primary",disabled:!v||!C||u,loading:u||a,children:s("users.editModal.save")})]})]})]})})},W=I(J),X=({t:l})=>[{header:l("users.columns.name"),enableSorting:!0,accessorFn:t=>t.firstName+" "+t.lastName,cell:({row:t})=>{const{firstName:r,lastName:i,imageUrl:n}=t.original;return e.jsxs("div",{className:"table-profile-component",children:[e.jsx(Q,{src:n,text:Y(r,i)}),e.jsx("strong",{children:r+" "+i})]})}},{header:l("users.columns.role"),enableSorting:!0,accessorKey:"roleId",enableGlobalFilter:!1,cell:({getValue:t})=>{var i;const r={root:"success",admin:"success",editor:"info",basic:"info"};return e.jsx("h4",{children:e.jsx(_,{bg:r[(i=t())==null?void 0:i.toLowerCase()],className:"text-light text-capitalize",children:t()})})}},{header:l("users.columns.email"),enableSorting:!0,accessorKey:"email"},{header:l("users.columns.active"),enableSorting:!0,accessorKey:"isActive",enableGlobalFilter:!1,cell:({getValue:t})=>{var r,i;return e.jsx("strong",{className:k(((r=t())==null?void 0:r.toString().toLowerCase())==="true"?"text-success":"text-danger","text-capitalize"),children:((i=t())==null?void 0:i.toString())=="true"?l("common.yes"):l("common.no")})}},{header:"",accessorKey:"edit",cell:({row:t})=>{const{id:r}=t.original,{accountStore:i}=w(),{currentUser:n}=i,{show:a,onShow:p,onHide:x}=D();return e.jsxs(e.Fragment,{children:[r!=(n==null?void 0:n.id)?e.jsx("button",{className:"btn btn-soft-primary rounded-pill",onClick:p,children:l("users.columns.edit")}):l("users.columns.naYou"),a&&e.jsx(W,{show:a,onHide:x,data:t.original})]})}}],Z=({show:l,onHide:t})=>{const{usersStore:r}=w(),{createAppUser:i,loading:n}=r,{t:a}=P(),p=N.useMemo(()=>({id:"",firstName:"",lastName:"",email:"",password:"Password123!",phoneNumber:"",roleId:"basic"}),[]),x=B({firstName:m().required(a("users.registerModal.validation.firstNameRequired")),lastName:m().required(a("users.registerModal.validation.lastNameRequired")),email:m().required(a("users.registerModal.validation.emailRequired")).email(a("users.registerModal.validation.emailInvalid")),password:m().required(a("users.registerModal.validation.passwordRequired")),phoneNumber:m(),roleId:m().oneOf(["admin","editor","basic"])}),{reset:s,register:c,handleSubmit:f,formState:{isDirty:M,isValid:h,isSubmitting:S}}=T({defaultValues:p,resolver:z(x)}),v=()=>{s(),t()},C=async u=>{try{await i(u),j.success(a("users.registerModal.createSuccess")),v()}catch(y){const U=(y==null?void 0:y.message)||a("users.registerModal.createFailed");j.error(U)}};return e.jsx(E,{show:l,onHide:v,headerTitle:a("users.registerModal.addTitle"),children:e.jsxs("form",{onSubmit:f(u=>C({...p,...u})),children:[e.jsxs(K,{className:"mt-1",children:[e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:a("users.registerModal.firstNameLabel"),placeholder:a("users.registerModal.firstNamePlaceholder"),register:c,name:"firstName"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:a("users.registerModal.lastNameLabel"),placeholder:a("users.registerModal.lastNamePlaceholder"),register:c,name:"lastName"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:a("users.registerModal.emailLabel"),placeholder:a("users.registerModal.emailPlaceholder"),register:c,name:"email"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:a("users.registerModal.phoneNumberLabel"),placeholder:a("users.registerModal.phoneNumberPlaceholder"),register:c,name:"phoneNumber"})}),e.jsx(d,{className:"mt-2",xs:12,sm:6,children:e.jsx(o,{type:"text",label:a("users.registerModal.passwordLabel"),placeholder:a("users.registerModal.passwordPlaceholder"),register:c,name:"password"})}),e.jsxs(d,{className:"mt-2",xs:12,children:[e.jsx("h6",{className:"fs-6 mb-1",children:a("users.registerModal.roleLabel")}),e.jsx(O,{direction:"horizontal",gap:1,children:["admin","editor","basic"].map(u=>e.jsx(o,{type:"radio",value:u,label:u,register:c,name:"roleId",className:"text-capitalize"},u))})]})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4 gap-2",children:[e.jsx(A,{variant:"light",onClick:()=>v(),children:a("users.registerModal.cancel")}),e.jsx(q,{type:"submit",variant:"primary",disabled:!M||!h||S,loading:S||n,children:a("users.registerModal.save")})]})]})})},ee=I(Z),se=()=>{const{usersStore:l,authStore:t}=w(),{loadAppUsers:r,appUsersSorted:i,loadingInitial:n}=l,{show:a,onShow:p,onHide:x}=D(),{t:s,i18n:c}=P();N.useEffect(()=>{t.setTitle(s("users.title"))},[s,t,c.language]);const f=N.useMemo(()=>i,[i]),M=N.useMemo(()=>X({t:s}),[s]);return N.useEffect(()=>{r()},[r]),e.jsxs(H,{action:e.jsx(A,{variant:"primary",onClick:p,children:s("users.newUser")}),children:[a&&e.jsx(ee,{show:a,onHide:x}),e.jsx(F,{className:"pt-2",children:e.jsx(F.Body,{children:e.jsx($,{data:f,columns:M,getCoreRowModel:V(),isLoading:n,filterFieldPlaceholder:s("users.searchPlaceholder")})})}),e.jsx("div",{className:"mb-2",children:e.jsx("small",{children:s("users.paginationDescription")})})]})},$e=I(se);export{$e as default};
