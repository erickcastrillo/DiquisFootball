import{o as F,a as v,r as g,j as e,Q as N}from"./index-B9lOP-LQ.js";import{C as O}from"./ClientTable-D9B5AJGL.js";import{c as R,a as l,F as r,b as $}from"./object-C6BzUNZs.js";import{u as P,o as k}from"./yup-BjqEEnFb.js";import"./world-DCpaYJzq.js";import{L as I}from"./LoadingButton-CKSAYktE.js";import{M as B,u as T,g as G}from"./index-CuAXanPx.js";import{R as z}from"./Row-Bt1Diq2_.js";import{C as i}from"./Col-C-S0H3jR.js";import{S as D}from"./Stack-DjFs0eJ8.js";import{B as L}from"./Button-474b3BA8.js";import{c as K}from"./clsx-CH7BE6MN.js";import{A as V}from"./Avatar-CNF_UKqR.js";import{g as Y}from"./getInitials-fn6u8gr9.js";import{B as Q}from"./Badge-DZfFfHcf.js";import{P as _}from"./PageLayout-BwASRJfk.js";import{C as q}from"./Card-CaF0GZJy.js";import"./simplebar-react.esm-bGe56t2G.js";import"./index-CF5aMJY4.js";import"./ElementChildren-C2-i1Qbu.js";import"./InputGroupContext-DzKQQVdm.js";import"./setPrototypeOf-DgZC2w_0.js";import"./warning-B3rqXDKQ.js";import"./Modal-B-wCig5c.js";import"./listen-DOhMskc_.js";import"./useCallbackRef-B-qOTvYu.js";import"./useEventCallback-B-qJwqMD.js";import"./useMergedRefs-DJgFqpix.js";import"./hasClass-C7eJW1sn.js";import"./useWindow-BKmZcn0M.js";import"./NoopTransition-Bi7248SM.js";import"./TransitionWrapper-BLPpPSai.js";import"./objectWithoutPropertiesLoose-Dsqj8S3w.js";import"./AbstractModalHeader-CEqb6A66.js";import"./contains-xpjwsOxO.js";import"./usePrevious-mZ2y6jh4.js";import"./DataKey-COGXBUcQ.js";import"./CloseButton-BF3uFok-.js";import"./Fade-Dtw2Fl4v.js";import"./divWithClassName-_xz-H_CW.js";import"./Button-dKWbp8U8.js";const H=({show:a,onHide:t})=>{const{usersStore:s}=v(),{createAppUser:o,loading:c}=s,d=g.useMemo(()=>({id:"",firstName:"",lastName:"",email:"",password:"Password123!",phoneNumber:"",roleId:"basic"}),[]),h=R({firstName:l().required("The first name is required"),lastName:l().required("The last name is required"),email:l().required().email(),password:l().required(),phoneNumber:l(),roleId:l().oneOf(["admin","editor","basic"])}),{reset:j,register:m,handleSubmit:U,formState:{isDirty:C,isValid:p,isSubmitting:y}}=P({defaultValues:d,resolver:k(h)}),b=()=>{j(),t()},w=async n=>{try{await o(n),N.success("User Added Successfully!"),b()}catch(f){const A=f==null?void 0:f.message;N.error(A)}};return e.jsx(B,{show:a,onHide:b,headerTitle:"Add User",children:e.jsxs("form",{onSubmit:U(n=>w({...d,...n})),children:[e.jsxs(z,{className:"mt-1",children:[e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"First Name",placeholder:"First Name",register:m,name:"firstName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"Last Name",placeholder:"Last Name",register:m,name:"lastName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"Email",placeholder:"user@email.com",register:m,name:"email"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"Phone Number",placeholder:"Phone Number",register:m,name:"phoneNumber"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"Password",placeholder:"Password",register:m,name:"password"})}),e.jsxs(i,{className:"mt-2",xs:12,children:[e.jsx("h6",{className:"fs-6 mb-1",children:"Role"}),e.jsx(D,{direction:"horizontal",gap:1,children:["admin","editor","basic"].map(n=>e.jsx(r,{type:"radio",value:n,label:n,register:m,name:"roleId",className:"text-capitalize"},n))})]})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4 gap-2",children:[e.jsx(L,{variant:"light",onClick:()=>b(),children:"Cancel"}),e.jsx(I,{type:"submit",variant:"primary",disabled:!C||!p||y,loading:y||c,children:"Save"})]})]})})},J=F(H),W=({show:a,onHide:t,data:s})=>{const{usersStore:o}=v(),{updateAppUser:c,loading:d,loadingDelete:h,deleteAppUser:j}=o,m=g.useMemo(()=>({id:s.id,firstName:s.firstName,lastName:s.lastName,email:s.email,phoneNumber:s.phoneNumber,isActive:s.isActive,roleId:s.roleId,imageUrl:s.imageUrl,createdOn:s.createdOn}),[s]),U=R({firstName:l().required("The first name is required"),lastName:l().required("The last name is required"),email:l().required().email(),phoneNumner:l(),roleId:l().oneOf(["admin","editor","basic"]),isActive:$()}),{reset:C,register:p,handleSubmit:y,formState:{isDirty:b,isValid:w,isSubmitting:n}}=P({defaultValues:m,resolver:k(U)}),f=async x=>{try{await j(x),N.error("User Deleted Successfully!"),t()}catch(u){const M=u==null?void 0:u.message;N.error(M)}},A=async x=>{try{await c(x),N.info("User Edited Successfully!"),t(),C()}catch(u){const M=u==null?void 0:u.message;N.error(M)}},S=s.roleId==="root";return e.jsx(B,{show:a,onHide:t,headerTitle:"Edit User",children:e.jsxs("form",{onSubmit:y(A),children:[e.jsxs(z,{className:"mt-1",children:[!S&&e.jsx(i,{className:"mt-2",xs:12,children:e.jsx(r,{type:"checkbox",label:"Is Active",register:p,name:"isActive"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"First Name",placeholder:"First Name",register:p,name:"firstName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"Last Name",placeholder:"Last Name",register:p,name:"lastName"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"Email",placeholder:"user@email.com",register:p,name:"email"})}),e.jsx(i,{className:"mt-2",xs:12,sm:6,children:e.jsx(r,{type:"text",label:"Phone Number",placeholder:"Phone Number",register:p,name:"phoneNumber"})}),!S&&e.jsxs(i,{className:"mt-2",xs:12,children:[e.jsx("h6",{className:"fs-6 mb-1",children:"Role"}),e.jsx(D,{direction:"horizontal",gap:1,children:["admin","editor","basic"].map(x=>e.jsx(r,{type:"radio",value:x,label:x,register:p,name:"roleId",className:"text-capitalize"},x))})]})]}),e.jsxs("div",{className:K("d-flex",S?"justify-content-end":"justify-content-between","mt-4"),children:[!S&&e.jsx(I,{variant:"danger",loading:h,onClick:()=>f(s.id),children:"Delete"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(L,{variant:"light",onClick:t,children:"Cancel"}),e.jsx(I,{type:"submit",variant:"primary",disabled:!b||!w||n,loading:n||d,children:"Save"})]})]})]})})},X=F(W),E=[{header:"Name",enableSorting:!0,accessorFn:a=>a.firstName+" "+a.lastName,cell:({row:a})=>{const{firstName:t,lastName:s,imageUrl:o}=a.original;return e.jsxs("div",{className:"table-profile-component",children:[e.jsx(V,{src:o,text:Y(t,s)}),e.jsx("strong",{children:t+" "+s})]})}},{header:"Role",enableSorting:!0,accessorKey:"roleId",enableGlobalFilter:!1,cell:({getValue:a})=>{var s;const t={root:"success",admin:"success",editor:"info",basic:"info"};return e.jsx("h4",{children:e.jsx(Q,{bg:t[(s=a())==null?void 0:s.toLowerCase()],className:"text-light text-capitalize",children:a()})})}},{header:"Email",enableSorting:!0,accessorKey:"email"},{header:"Active",enableSorting:!0,accessorKey:"isActive",enableGlobalFilter:!1,cell:({getValue:a})=>{var t,s;return e.jsx("strong",{className:K(((t=a())==null?void 0:t.toString().toLowerCase())==="true"?"text-success":"text-danger","text-capitalize"),children:((s=a())==null?void 0:s.toString())=="true"?"Yes":"No"})}},{header:"",accessorKey:"edit",cell:({row:a})=>{const{id:t}=a.original,{accountStore:s}=v(),{currentUser:o}=s,{show:c,onShow:d,onHide:h}=T();return e.jsxs(e.Fragment,{children:[t!=(o==null?void 0:o.id)?e.jsx("button",{className:"btn btn-soft-primary rounded-pill",onClick:d,children:"Edit"}):"N/A(You)",c&&e.jsx(X,{show:c,onHide:h,data:a.original})]})}}],Z=()=>{const{usersStore:a}=v(),{loadAppUsers:t,appUsersSorted:s,loadingInitial:o}=a,{show:c,onShow:d,onHide:h}=T(),j=g.useMemo(()=>s,[s]),m=g.useMemo(()=>E,[E]);return g.useEffect(()=>{t()},[t]),e.jsxs(_,{title:"Users",action:e.jsx(L,{variant:"primary",onClick:d,children:"New User"}),children:[c&&e.jsx(J,{show:c,onHide:h}),e.jsx(q,{className:"pt-2",children:e.jsx(q.Body,{children:e.jsx(O,{data:j,columns:m,getCoreRowModel:G(),isLoading:o,filterFieldPlaceholder:"Search users..."})})}),e.jsx("div",{className:"mb-2",children:e.jsx("small",{children:"Client-side pagination with sorting & filtering"})})]})},Ke=F(Z);export{Ke as default};
